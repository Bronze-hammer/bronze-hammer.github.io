<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>SpringBoot与SpringCloud | 徐子辉的个人站点</title>
  <meta name="author" content="xuzh">
  
  <meta name="description" content="1. SpringBoot
1.1 SpringBoot的作用
SpringBoot是一个快速构建项目并简化项目配置的工具，内部集成了Tomcat及大多数第三方应用和Spring框架的默认配置。与我们学习的SpringMVC和SpringCloud并无冲突,SpringBoot提供的这些默认配置，大大简化了SpringMVC、SpringCloud等基于Spring的Web应用的开发。
1.2.SpringBoot的自动配置原理（如何实现）？
SpringBoot的自动配置是如何实现的？
一般我们的SpringBoot项目启动类都会添加@SpringBootApplication注解，而这个注解的其中一个二级注解是@EnableAutoConfiguration注解。而@EnableAutoConfiguration注解通过@Import注解，以ImportSelector接口的方法来导入classpath下的META-INF/spring.factories文件，这些文件中会指定需要加载的一些类名称。
这些类一般都加了@Configuration注解，并且完成了对某框架（例如Redis、SpringMVC）的默认配置，当这些类符合条件时，就会被实例化，其中的配置生效，那么自动配置自然生效了。">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="SpringBoot与SpringCloud">
  <meta property="og:site_name" content="徐子辉的个人站点">

  
    <meta property="og:image" content>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  

</head>
</html>
 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">徐子辉的个人站点</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-user"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> SpringBoot与SpringCloud</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="springboot">1. SpringBoot</h1>
<h2 id="springboot的作用">1.1 SpringBoot的作用</h2>
<p>SpringBoot是一个快速构建项目并简化项目配置的工具，内部集成了Tomcat及大多数第三方应用和Spring框架的默认配置。与我们学习的SpringMVC和SpringCloud并无冲突,SpringBoot提供的这些默认配置，大大简化了SpringMVC、SpringCloud等基于Spring的Web应用的开发。</p>
<h2 id="springboot的自动配置原理如何实现">1.2.SpringBoot的自动配置原理（如何实现）？</h2>
<h3 id="springboot的自动配置是如何实现的">SpringBoot的自动配置是如何实现的？</h3>
<p>一般我们的SpringBoot项目启动类都会添加<code>@SpringBootApplication</code>注解，而这个注解的其中一个二级注解是<code>@EnableAutoConfiguration</code>注解。而<code>@EnableAutoConfiguration</code>注解通过<code>@Import</code>注解，以<code>ImportSelector</code>接口的方法来导入classpath下的<code>META-INF/spring.factories</code>文件，这些文件中会指定需要加载的一些类名称。</p>
<p>这些类一般都加了<code>@Configuration</code>注解，并且完成了对某框架（例如Redis、SpringMVC）的默认配置，当这些类符合条件时，就会被实例化，其中的配置生效，那么自动配置自然生效了。</p>
<a id="more"></a>
<h3 id="满足怎样的条件配置才会生效">满足怎样的条件配置才会生效？</h3>
<p>一般提供默认配置的类都会添加<code>@ConditionalOnXxx</code>这样的注解，例如：<code>@ConditionalOnClass</code>，<code>@ConditionalOnProperties</code>等。<code>@ConditionalOnClass</code>表示只有classpath中存在某些指定的类时，条件满足，此时该配置类才会生效。例如Redis的默认配置其实早就有了，但是只有你引入redis的starter依赖，才满足了条件，触发自动配置。</p>
<h3 id="那如果我需要覆盖这些默认配置呢">那如果我需要覆盖这些默认配置呢？</h3>
<p>有两种方式可以覆盖默认配置：</p>
<ul>
<li>SpringBoot提供默认配置时，会在提供的Bean上加注解@ConditionalOnMissingBean，意思是如果这个Bean不存在时条件满足，那么我们只要配置了相同的Bean，那么SpringBoot提供的默认配置就会失效</li>
<li>SpringBoot提供默认配置时，一些关键属性会通过读取application.yml或者application.properties文件来获取，因此我们可以通过覆盖任意一个文件中的属性来覆盖默认配置。</li>
</ul>
<h2 id="自定义springboot的stater">1.3 自定义SpringBoot的stater？</h2>
<p>项目中某些中间件的客户端（如Redis、ElasticSearch）会进行二次封装，并通过starter方式提供jar包，供大家使用。</p>
<p>一般定义starter包括下面几个子工程：</p>
<ul>
<li>xxx-spring-boot-starter：pom格式，管理当前starter中需要的各种依赖</li>
<li>xxx-spring-boot-autoconfigure：jar格式，自动配置的核心代码</li>
</ul>
<p>以elasticsearch为例来说说autoconfigure中包含哪些</p>
<ul>
<li>elasticsearch的工具类</li>
<li>属性加载的类，一般通过@ConfigurationProperties注解读取yaml文件中的es地址</li>
<li>添加了@Configuration的配置类，作用是初始化elasticsearch工具类，初始化elasticsearch客户端，初始化一些其它必备的实例。</li>
<li>resource下定义META-INF文件夹，并且文件夹下定义spring.factories文件，文件中是key-value形式:key是EnableAutoConfiguration这个注解的全路径名,value是我们自定义自动配置类（加了@Configuration的类），如果有多个以","隔开</li>
</ul>
<h2 id="springboot项目的启动流程">1.4 SpringBoot项目的启动流程</h2>
<p>SpringBoot项目启动第一步就是创建SpringApplication的实例，并且调用SpringApplication.run()这个方法。</p>
<p>创建SpringApplication实例主要完成三件事情：</p>
<ul>
<li>记录当前启动类字节码</li>
<li>判断当前项目类型，普通Servlet、响应式WebFlux、NONE</li>
<li>加载/META-INF/spring.factories文件，初始化ApplicationContextInitializer和ApplicationListener实例</li>
</ul>
<p>而后的run()方法则会创建spring容器，流程如下：</p>
<ul>
<li>准备监听器，监听Spring启动的各个过程</li>
<li>创建并配置环境参数Environment</li>
<li>创建ApplicationContext</li>
<li>prepareContext()：初始化ApplicationContext，准备运行环境</li>
<li>refreshContext(context)：准备Bean工厂，调用一个BeanDefinition和BeanFactory的后处理器，初始化各种Bean，初始化tomcat</li>
<li>afterRefresh()：拓展功能，目前为空</li>
<li>发布容器初始化完毕的事件</li>
</ul>
<h2 id="springboot的配置加载优先级">1.5 SpringBoot的配置加载优先级</h2>
<p>SpringBoot参数配置方式很多，比较常用参数配置方式按照优先级从高到低分别是：</p>
<ul>
<li>在命令行中传入的参数</li>
<li>java 的系统属性，可以通过System.getProperties()获得的内容</li>
<li>操作系统的环境变量</li>
<li>针对不同{profile}环境的配置文件内容，例如
applicaiton-{profile}.yaml</li>
<li>application.yml或application.proerties文件</li>
<li>在@Configration注解修改的类中，通过@PropertySource注解定义的属性</li>
</ul>
<h1 id="springcloud">2 SpringCloud</h1>
<h2 id="springcloud和dubbo的区别">2.1 SpringCloud和Dubbo的区别</h2>
<p>两者都是现在主流的微服务框架，但却存在不少差异：</p>
<ul>
<li>初始定位不同：SpringCloud定位为微服务架构下的一站式解决方案；Dubbo
是 SOA 时代的产物，它的关注点主要在于服务的调用和治理</li>
<li>生态环境不同：SpringCloud依托于Spring平台，具备更加完善的生态体系；而Dubbo一开始只是做RPC远程调用，生态相对匮乏，现在逐渐丰富起来。</li>
<li>调用方式：SpringCloud是采用Http协议做远程调用，接口一般是Rest风格，比较灵活；Dubbo是采用Dubbo协议，接口一般是Java的Service接口，格式固定。但调用时采用Netty的NIO方式，性能较好。</li>
<li>组件差异比较多，例如SpringCloud注册中心一般用Eureka，而Dubbo用的是Zookeeper</li>
</ul>
<p>SpringCloud生态丰富，功能完善，更像是品牌机，Dubbo则相对灵活，可定制性强，更像是组装机。</p>
<table>
<thead>
<tr class="header">
<th>功能</th>
<th>Dubbo</th>
<th>SpringCloud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>服务注册中心</td>
<td>Zookeeper</td>
<td>Eureka(主流）、Consul、zookeeper</td>
</tr>
<tr class="even">
<td>服务调用方式</td>
<td>RPC基于Dubbo协议</td>
<td>REST API 基于Http协议</td>
</tr>
<tr class="odd">
<td>服务监控</td>
<td>Dubbo-Monitor</td>
<td>Spring Boot Admin</td>
</tr>
<tr class="even">
<td>熔断器</td>
<td>不完善</td>
<td>Spring Cloud Netflix Hystrix</td>
</tr>
<tr class="odd">
<td>服务网关</td>
<td>无</td>
<td>Spring Cloud Netflix Zuul、Gateway</td>
</tr>
<tr class="even">
<td>分布式配置</td>
<td>无</td>
<td>Spring Cloud Config</td>
</tr>
<tr class="odd">
<td>服务跟踪</td>
<td>无</td>
<td>Spring Cloud Sleuth+Zipkin(一般)</td>
</tr>
<tr class="even">
<td>数据流</td>
<td>无</td>
<td>Spring Cloud Stream</td>
</tr>
<tr class="odd">
<td>批量任务</td>
<td>无</td>
<td>Spring Cloud Task</td>
</tr>
<tr class="even">
<td>信息总线</td>
<td>无</td>
<td>Spring Cloud Bus</td>
</tr>
</tbody>
</table>
<hr>
<p>未完待续</p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a type="button" class="btn btn-default disabled"><i class="fa fa-arrow-circle-o-left"></i>Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/06/30/MyBatis配置allowMultiQueries-true允许使用foreach标签批量插入或更新数据/" type="button" class="btn btn-default ">Next<i class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
    <script src="https://giscus.app/client.js" data-repo="xbronze/giscus" data-repo-id="R_kgDOJ4tM7g" data-category="Announcements" data-category-id="DIC_kwDOJ4tM7s4CXvDw" data-mapping="title" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async>
    </script>
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-07-14 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    </li><li><a href="/categories/代码人生/">代码人生<span>13</span></a></li>
  

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <a href="/tags/SpringCloud/">SpringCloud<span>2</span></a> <a href="/tags/SpringBoot/">SpringBoot<span>2</span></a>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#springboot"><span class="toc-article-text">1. SpringBoot</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#springboot的作用"><span class="toc-article-text">1.1 SpringBoot的作用</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#springboot的自动配置原理如何实现"><span class="toc-article-text">1.2.SpringBoot的自动配置原理（如何实现）？</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#springboot的自动配置是如何实现的"><span class="toc-article-text">SpringBoot的自动配置是如何实现的？</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#满足怎样的条件配置才会生效"><span class="toc-article-text">满足怎样的条件配置才会生效？</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#那如果我需要覆盖这些默认配置呢"><span class="toc-article-text">那如果我需要覆盖这些默认配置呢？</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#自定义springboot的stater"><span class="toc-article-text">1.3 自定义SpringBoot的stater？</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#springboot项目的启动流程"><span class="toc-article-text">1.4 SpringBoot项目的启动流程</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#springboot的配置加载优先级"><span class="toc-article-text">1.5 SpringBoot的配置加载优先级</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#springcloud"><span class="toc-article-text">2 SpringCloud</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#springcloud和dubbo的区别"><span class="toc-article-text">2.1 SpringCloud和Dubbo的区别</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2023 xuzh
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>,
     <br> Theme by <a href="https://github.com/blackshow/hexo-theme-freemind.386">Hexo-Theme-Freemind.386</a>.    
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
